"use strict";(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([[501],{2501:(E,m,s)=>{s.r(m),s.d(m,{CartPage:()=>F});var l=s(467),_=s(1400),u=s(7411),n=s(2615),g=s(3283),d=s(2200),p=s(3243),t=s(3664);const b=(a,c)=>({"bg-blue-500 text-white":a,"bg-gray-300 text-black hover:bg-gray-400":c});function P(a,c){1&a&&(t.j41(0,"div",2),t.EFF(1,"Loading cart..."),t.k0s())}function h(a,c){1&a&&(t.j41(0,"div",2),t.EFF(1,"Your cart is empty."),t.k0s())}function x(a,c){if(1&a){const e=t.RV6();t.j41(0,"div",6),t.nrm(1,"img",7),t.j41(2,"span",8),t.EFF(3),t.k0s(),t.j41(4,"div",9)(5,"span",10),t.EFF(6),t.nI1(7,"number"),t.k0s(),t.j41(8,"span",11),t.EFF(9),t.k0s(),t.j41(10,"span",12),t.EFF(11),t.nI1(12,"number"),t.k0s()(),t.j41(13,"div",13)(14,"button",14),t.bIt("click",function(){const i=n.eBV(e).$implicit,o=t.XpG(3);return n.Njj(o.updateQuantity(i.productId._id,i.quantity-1))}),t.EFF(15," - "),t.k0s(),t.j41(16,"span",15),t.EFF(17),t.k0s(),t.j41(18,"button",14),t.bIt("click",function(){const i=n.eBV(e).$implicit,o=t.XpG(3);return n.Njj(o.updateQuantity(i.productId._id,i.quantity+1))}),t.EFF(19," + "),t.k0s()(),t.j41(20,"button",16),t.bIt("click",function(){const i=n.eBV(e).$implicit,o=t.XpG(3);return n.Njj(o.removeItem(i.productId._id))}),t.EFF(21," Remove "),t.k0s()()}if(2&a){const e=c.$implicit;t.R7$(),t.Y8G("src",e.productId.images[0],t.B4B)("alt",e.productId.productName),t.R7$(2),t.SpI(" ",e.productId.productName," "),t.R7$(3),t.SpI(" \u20b9",t.i5U(7,7,e.productId.price,"1.2-2")," "),t.R7$(3),t.SpI(" -",e.productId.discount?e.productId.discount:0,"% "),t.R7$(2),t.SpI(" \u20b9",t.i5U(12,10,e.productId.price*(1-(e.productId.discount||0)/100)*e.quantity,"1.2-2")," "),t.R7$(6),t.JRh(e.quantity)}}function C(a,c){if(1&a&&(t.j41(0,"div",3),t.Z7z(1,x,22,13,"div",6,t.Vm6),t.k0s()),2&a){const e=t.XpG(2);t.R7$(),t.Dyx(e.paginatedItems)}}function v(a,c){if(1&a){const e=t.RV6();t.j41(0,"button",19),t.bIt("click",function(){const i=n.eBV(e).$implicit,o=t.XpG(3);return n.Njj(o.goToPage(i))}),t.EFF(1),t.k0s()}if(2&a){const e=c.$implicit,r=t.XpG(3);t.Y8G("ngClass",t.l_i(2,b,r.currentPage===e,r.currentPage!==e)),t.R7$(),t.SpI(" ",e," ")}}function I(a,c){if(1&a){const e=t.RV6();t.j41(0,"div",4)(1,"button",17),t.bIt("click",function(){n.eBV(e);const i=t.XpG(2);return n.Njj(i.prevPage())}),t.EFF(2," Prev "),t.k0s(),t.Z7z(3,v,2,5,"button",18,t.Vm6),t.j41(5,"button",17),t.bIt("click",function(){n.eBV(e);const i=t.XpG(2);return n.Njj(i.nextPage())}),t.EFF(6," Next "),t.k0s()()}if(2&a){const e=t.XpG(2);t.R7$(),t.Y8G("disabled",1===e.currentPage),t.R7$(2),t.Dyx(e.pageNumbers),t.R7$(2),t.Y8G("disabled",e.currentPage===e.totalPages)}}function f(a,c){if(1&a){const e=t.RV6();t.j41(0,"div",5)(1,"div",20)(2,"h2",21),t.EFF(3," Cart Summary "),t.k0s(),t.j41(4,"div",22),t.EFF(5),t.nI1(6,"number"),t.k0s(),t.j41(7,"div",23),t.EFF(8),t.nI1(9,"number"),t.nI1(10,"number"),t.k0s(),t.j41(11,"div",24),t.EFF(12," Final Amount: "),t.j41(13,"span",25),t.EFF(14,"\u20b9"),t.k0s(),t.j41(15,"span",26),t.EFF(16),t.nI1(17,"number"),t.k0s()()(),t.j41(18,"div",27)(19,"button",28),t.bIt("click",function(){n.eBV(e);const i=t.XpG(2);return n.Njj(i.proceedToCheckout())}),t.EFF(20," Proceed to Checkout "),t.k0s(),t.j41(21,"button",29),t.bIt("click",function(){n.eBV(e);const i=t.XpG(2);return n.Njj(i.clearCart())}),t.EFF(22," Clear Cart "),t.k0s()()()}if(2&a){const e=t.XpG(2);t.R7$(5),t.SpI(" Total Amount: \u20b9",t.i5U(6,6,e.originalTotal,"1.2-2")," "),t.R7$(3),t.Lme(" Total Discount: ",t.i5U(9,9,e.totalDiscount,"1.2-2"),"% (\u20b9",t.i5U(10,12,e.totalDiscountAmount,"1.2-2"),") "),t.R7$(8),t.JRh(t.i5U(17,15,e.totalAmount,"1.2-2")),t.R7$(3),t.Y8G("disabled",0===e.cartItems.length),t.R7$(2),t.Y8G("disabled",0===e.cartItems.length)}}function y(a,c){if(1&a&&(t.nVh(0,h,2,0,"div",2),t.nVh(1,C,3,0,"div",3),t.nVh(2,I,7,2,"div",4),t.nVh(3,f,23,18,"div",5)),2&a){const e=t.XpG();t.vxM(e.loading||0!==e.paginatedItems.length?-1:0),t.R7$(),t.vxM(e.paginatedItems.length>0?1:-1),t.R7$(),t.vxM(e.totalPages>1?2:-1),t.R7$(),t.vxM(e.cartItems.length>0?3:-1)}}let F=(()=>{class a{commonServices=(0,n.WQX)(u.e);customerServices=(0,n.WQX)(g.f);commonVariablesService=(0,n.WQX)(_.y);router=(0,n.WQX)(p.Ix);cartItems=[];currentPage=1;itemsPerPage=4;totalPages=0;paginatedItems=[];loading=!1;ngOnInit(){this.loadCart()}loadCart(){var e=this;return(0,l.A)(function*(){e.loading=!0;try{const r=localStorage.getItem("user");e.commonVariablesService.userData=JSON.parse(r||"{}");const i=e.commonVariablesService.userData._id,o=yield e.customerServices.getUserCart(i).toPromise();e.commonVariablesService.cartData=o,e.cartItems=o?.productQuantity||[],e.totalPages=Math.ceil(e.cartItems.length/e.itemsPerPage),e.currentPage>e.totalPages&&(e.currentPage=e.totalPages||1),e.updatePaginatedItems()}catch(r){console.error(r)}finally{e.loading=!1}})()}updatePaginatedItems(){const e=(this.currentPage-1)*this.itemsPerPage;this.paginatedItems=this.cartItems.slice(e,e+this.itemsPerPage)}goToPage(e){this.currentPage=e,this.updatePaginatedItems()}nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.updatePaginatedItems())}prevPage(){this.currentPage>1&&(this.currentPage--,this.updatePaginatedItems())}removeItem(e){var r=this;return(0,l.A)(function*(){const i=r.commonVariablesService.userData._id;yield r.customerServices.removeFromCart({userId:i,productId:e}).toPromise(),yield r.loadCart()})()}updateQuantity(e,r){var i=this;return(0,l.A)(function*(){if(r<1)return;const o={userId:i.commonVariablesService.userData._id,productId:e,quantity:r};yield i.customerServices.addToCart(o).toPromise(),yield i.loadCart()})()}get pageNumbers(){return Array.from({length:this.totalPages},(e,r)=>r+1)}get originalTotal(){return this.cartItems.reduce((e,r)=>e+(r.productId.price||0)*r.quantity,0)}get totalDiscountAmount(){return this.cartItems.reduce((e,r)=>e+(r.productId.price||0)*(r.productId.discount||0)/100*r.quantity,0)}get totalDiscount(){return 0===this.originalTotal?0:this.totalDiscountAmount/this.originalTotal*100}get totalAmount(){return this.originalTotal-this.totalDiscountAmount}proceedToCheckout(){0!==this.cartItems.length&&(this.commonVariablesService.orderSuccessData=null,this.router.navigateByUrl("/checkout"))}clearCart(){var e=this;return(0,l.A)(function*(){e.loading=!0,yield e.commonServices.clearCart(),e.cartItems=[],e.updatePaginatedItems()})()}static \u0275fac=function(r){return new(r||a)};static \u0275cmp=t.VBU({type:a,selectors:[["app-cart-page"]],decls:5,vars:1,consts:[[1,"p-[2rem]","mt-[2rem]"],[1,"text-[1.875rem]","font-semibold","mb-[1rem]"],[1,"text-[1rem]","text-gray-500"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","lg:grid-cols-4","gap-[1.5rem]"],[1,"flex","justify-center","items-center","gap-[0.5rem]","mt-[1.5rem]"],[1,"mt-[2rem]","p-[1.5rem]","border","rounded-[0.5rem]","flex","flex-col","md:flex-row","justify-between","items-start","md:items-center","bg-gray-100"],[1,"border","rounded-[0.5rem]","p-[1rem]","flex","flex-col","items-center","shadow-sm","hover:shadow-md","transition-shadow","bg-white"],[1,"w-full","h-[10rem]","object-cover","rounded-[0.5rem]","mb-[0.5rem]",3,"src","alt"],[1,"text-[1rem]","font-medium","text-gray-700","mb-[0.5rem]","text-center"],[1,"flex","flex-col","items-center","mb-[0.5rem]","text-center"],[1,"text-[0.875rem]","text-gray-500","line-through"],[1,"text-[0.875rem]","text-red-500"],[1,"text-[1rem]","font-semibold","text-gray-900"],[1,"flex","items-center","mb-[0.5rem]"],[1,"px-[0.5rem]","py-[0.25rem]","bg-gray-300","rounded-[0.25rem]","hover:bg-gray-400",3,"click"],[1,"px-[0.75rem]","text-[1rem]"],[1,"px-[0.75rem]","py-[0.5rem]","bg-red-500","text-white","rounded-[0.25rem]","hover:bg-red-600","transition-colors",3,"click"],[1,"px-[0.75rem]","py-[0.5rem]","bg-gray-300","rounded-[0.25rem]","hover:bg-gray-400","disabled:opacity-50",3,"click","disabled"],[1,"px-[0.75rem]","py-[0.5rem]","rounded-[0.25rem]","transition-colors",3,"ngClass"],[1,"px-[0.75rem]","py-[0.5rem]","rounded-[0.25rem]","transition-colors",3,"click","ngClass"],[1,"mb-[1rem]","md:mb-0","flex","flex-col","gap-[0.5rem]"],[1,"text-[1.25rem]","font-semibold","text-gray-900"],[1,"text-[1rem]","text-gray-500","line-through"],[1,"text-[1rem]","text-red-500"],[1,"text-[1.125rem]","font-semibold","text-gray-900"],[1,"bg-gradient-to-br","from-amber-400","via-yellow-500","to-amber-600","text-transparent","bg-clip-text"],[1,"text-green-500"],[1,"flex","gap-[1rem]"],[1,"px-[1rem]","py-[0.75rem]","bg-cyan-400","text-white","rounded-[0.5rem]","hover:bg-cyan-600","transition-colors","disabled:opacity-50",3,"click","disabled"],[1,"px-[1rem]","py-[0.75rem]","bg-red-500","text-white","rounded-[0.5rem]","hover:bg-red-600","transition-colors","disabled:opacity-50",3,"click","disabled"]],template:function(r,i){1&r&&(t.j41(0,"div",0)(1,"h1",1),t.EFF(2,"My Cart"),t.k0s(),t.nVh(3,P,2,0,"div",2)(4,y,4,4),t.k0s()),2&r&&(t.R7$(3),t.vxM(i.loading?3:4))},dependencies:[d.MD,d.YU,d.QX],encapsulation:2})}return a})()}}]);