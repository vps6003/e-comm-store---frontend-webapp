"use strict";(self.webpackChunkwebapp=self.webpackChunkwebapp||[]).push([[977],{9358:(q,f,m)=>{m.r(f),m.d(f,{CheckoutPage:()=>J});var d=m(467),j=m(7411),s=m(2615),E=m(1400),I=m(3283),u=m(2200),x=m(3694),i=m(9417),g=m(2629),w=m(1228),F=m(2155),v=m(2006),y=m(8834),e=m(3664),k=m(8983);function D(n,l){if(1&n&&e.EFF(0),2&n){const t=e.XpG();e.SpI(" #",t.orderData.orderId," ")}}function P(n,l){if(1&n&&e.EFF(0),2&n){const t=e.XpG();e.SpI(" , ",t.orderData.customerName," ")}}let V=(()=>{class n{router;toaster;orderData=null;confettiElements=[];constructor(t,r){this.router=t,this.toaster=r}ngOnit(){}ngAfterViewInit(){typeof document<"u"&&this.launchConfetti()}ngOnDestroy(){this.cleanupConfetti()}trackOrder(){const t=this.orderData?._id?.trim();t?this.router.navigate(["/orderDetails"],{queryParams:{orderId:t},state:{from:"order-summary"}}):(console.warn("Order ID not found, redirecting to orders list."),this.router.navigate(["/orders"]))}continueShopping(){this.router.navigate(["/"])}launchConfetti(){const t=document.getElementById("confetti-container");if(t){for(let r=0;r<80;r++){const o=document.createElement("div"),a=.4*Math.random()+.2;o.classList.add("confetti"),o.style.cssText=`\n        position: absolute;\n        width: ${a}rem;\n        height: ${3*a}rem;\n        background-color: ${this.randomColor()};\n        left: ${100*Math.random()}%;\n        top: -${10*Math.random()}%;\n        opacity: ${Math.random()};\n        transform: rotate(${360*Math.random()}deg);\n        animation: fall ${3+3*Math.random()}s linear infinite;\n        border-radius: 0.2rem;\n        pointer-events: none;\n      `,t.appendChild(o),this.confettiElements.push(o)}if(!document.getElementById("confetti-style")){const r=document.createElement("style");r.id="confetti-style",r.innerHTML="\n        @keyframes fall {\n          0% { transform: translateY(0) rotate(0deg); opacity: 1; }\n          100% { transform: translateY(110vh) rotate(360deg); opacity: 0; }\n        }\n      ",document.head.appendChild(r)}}}cleanupConfetti(){this.confettiElements.forEach(t=>t.remove()),this.confettiElements=[]}randomColor(){const t=["#06b6d4","#3b82f6","#facc15","#22c55e","#f472b6","#f97316"];return t[Math.floor(Math.random()*t.length)]}static \u0275fac=function(r){return new(r||n)(e.rXU(x.Ix),e.rXU(k.N))};static \u0275cmp=e.VBU({type:n,selectors:[["app-order-success-page"]],inputs:{orderData:"orderData"},decls:67,vars:15,consts:[[1,"relative","w-full","min-h-screen","flex","items-center","justify-center","p-[1.5rem]","bg-gradient-to-br","from-[#061826]","to-[#04293a]","overflow-hidden"],["id","confetti-container",1,"absolute","inset-0","pointer-events-none","overflow-hidden","z-0"],[1,"relative","z-10","w-full","max-w-[64rem]","bg-white/5","backdrop-blur-sm","rounded-[1.125rem]","p-[1.5rem]","grid","md:grid-cols-[26rem_1fr]","gap-[1rem]","shadow-[0_12px_40px_rgba(2,6,23,0.6)]"],[1,"flex","flex-col","items-center","justify-center","gap-[1rem]","p-[1rem]","rounded-[1rem]","text-center"],[1,"relative"],[1,"w-[6rem]","h-[6rem]","sm:w-[7rem]","sm:h-[7rem]","rounded-full","grid","place-items-center","bg-gradient-to-br","from-cyan-400","to-blue-500","shadow-lg","animate-bounce"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg",1,"w-[2rem]","h-[2rem]","sm:w-[2.25rem]","sm:h-[2.25rem]"],["d","M20 6L9 17l-5-5","stroke","#021124","stroke-width","1.6","stroke-linecap","round","stroke-linejoin","round"],[1,"text-[1.5rem]","sm:text-[1.6rem]","font-semibold","text-white"],[1,"text-[0.95rem]","sm:text-[1rem]","text-white/80","max-w-[22rem]"],[1,"w-full","mt-[0.5rem]","bg-white/6","border","border-white/10","rounded-[0.75rem]","p-[0.75rem]","text-[0.95rem]"],[1,"flex","items-center","justify-between","mb-[0.35rem]"],[1,"text-white/80"],[1,"font-medium","text-white"],[1,"font-semibold","text-white"],[1,"flex","items-center","justify-between"],[1,"mt-[0.75rem]","flex","gap-[0.5rem]","flex-wrap","justify-center","w-full"],[1,"px-[1rem]","py-[0.5rem]","rounded-[0.6rem]","bg-white/10","border","border-white/20","text-[1rem]","font-medium","text-white","hover:bg-white/20","transition",3,"click"],[1,"px-[1rem]","py-[0.5rem]","rounded-[0.6rem]","bg-cyan-400","text-[1rem]","font-semibold","text-[#021124]","hover:brightness-105","transition",3,"click"],[1,"p-[1rem]","flex","flex-col","justify-center","gap-[0.75rem]"],[1,"text-[1.2rem]","sm:text-[1.25rem]","font-semibold","text-white"],[1,"mt-[0.75rem]","space-y-[0.5rem]"],[1,"flex","items-start","gap-[0.75rem]"],[1,"text-[1rem]","text-green-300"],[1,"text-[0.95rem]","sm:text-[1rem]","text-white/80"],[1,"text-[1rem]","text-blue-300"],[1,"text-[1rem]","text-yellow-300"],[1,"mt-[1rem]","text-[0.95rem]","sm:text-[1rem]","text-white/70"],[1,"text-[0.85rem]","sm:text-[0.9rem]","text-white/60"],["href","/help",1,"underline","text-white/90"]],template:function(r,o){1&r&&(e.rj2(0,"section",0),e.Hgh(1,"div",1),e.rj2(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),s.qSk(),e.rj2(6,"svg",6),e.Hgh(7,"path",7),e.eux()()(),s.joV(),e.rj2(8,"h2",8),e.EFF(9,"Congratulations \u{1f389}"),e.eux(),e.rj2(10,"p",9),e.EFF(11," Your order "),e.nVh(12,D,1,1),e.EFF(13," has been successfully placed! Thank you "),e.nVh(14,P,1,1),e.EFF(15," for shopping with us. "),e.eux(),e.rj2(16,"div",10)(17,"div",11)(18,"span",12),e.EFF(19,"Items"),e.eux(),e.rj2(20,"span",13),e.EFF(21),e.eux()(),e.rj2(22,"div",11)(23,"span",12),e.EFF(24,"Total"),e.eux(),e.rj2(25,"span",14),e.EFF(26),e.nI1(27,"number"),e.eux()(),e.rj2(28,"div",15)(29,"span",12),e.EFF(30,"Delivery by"),e.eux(),e.rj2(31,"span",13),e.EFF(32),e.nI1(33,"date"),e.eux()()(),e.rj2(34,"div",16)(35,"button",17),e.VwU("click",function(){return o.trackOrder()}),e.EFF(36," Track order "),e.eux(),e.rj2(37,"button",18),e.VwU("click",function(){return o.continueShopping()}),e.EFF(38," Continue shopping "),e.eux()()(),e.rj2(39,"div",19)(40,"h3",20),e.EFF(41,"Next Steps"),e.eux(),e.rj2(42,"ul",21)(43,"li",22)(44,"span",23),e.EFF(45,"\u2714"),e.eux(),e.rj2(46,"p",24),e.EFF(47,"Payment successfully processed"),e.eux()(),e.rj2(48,"li",22)(49,"span",25),e.EFF(50,"\u{1f69a}"),e.eux(),e.rj2(51,"p",24),e.EFF(52," Your order is being packed and shipped "),e.eux()(),e.rj2(53,"li",22)(54,"span",26),e.EFF(55,"\u{1f4e6}"),e.eux(),e.rj2(56,"p",24),e.EFF(57," Delivery expected: "),e.rj2(58,"span",13),e.EFF(59),e.nI1(60,"date"),e.eux()()()(),e.rj2(61,"p",27),e.EFF(62," You\u2019ll get an email confirmation soon with your order details. "),e.eux(),e.rj2(63,"p",28),e.EFF(64," Need help? "),e.rj2(65,"a",29),e.EFF(66,"Contact support"),e.eux()()()()()),2&r&&(e.R7$(12),e.vxM(o.orderData.orderId?12:-1),e.R7$(2),e.vxM(o.orderData.customerName?14:-1),e.R7$(7),e.JRh(o.orderData.item.length??"-"),e.R7$(5),e.JRh(null!==o.orderData.finalAmount?"\u20b9 "+e.i5U(27,6,o.orderData.finalAmount,"1.2-2"):"-"),e.R7$(6),e.JRh(e.i5U(33,9,o.orderData.estimatedDeliveryDate,"dd/MM/yyyy")||"\u2014"),e.R7$(27),e.JRh(e.i5U(60,12,o.orderData.estimatedDeliveryDate,"dd/MM/yyyy")||"\u2014"))},dependencies:[u.QX,u.vh],encapsulation:2})}return n})();var h=m(7982),S=m(407);function T(n,l){1&n&&(e.j41(0,"mat-error"),e.EFF(1,"Name is required"),e.k0s())}function $(n,l){1&n&&(e.j41(0,"mat-error"),e.EFF(1,"Email is required"),e.k0s())}function R(n,l){1&n&&(e.j41(0,"mat-error"),e.EFF(1,"Enter a valid email"),e.k0s())}function M(n,l){1&n&&(e.j41(0,"mat-error"),e.EFF(1,"Phone number is required"),e.k0s())}function N(n,l){1&n&&(e.j41(0,"mat-error"),e.EFF(1,"Only numbers are allowed"),e.k0s())}function O(n,l){1&n&&(e.j41(0,"mat-error"),e.EFF(1,"Phone number must be 10 digits"),e.k0s())}function A(n,l){1&n&&(e.j41(0,"mat-error"),e.EFF(1,"Address is required"),e.k0s())}function X(n,l){1&n&&(e.j41(0,"mat-error"),e.EFF(1,"Please select a payment method"),e.k0s())}function B(n,l){1&n&&(e.j41(0,"div",17),e.EFF(1," Your cart is empty. "),e.k0s())}function G(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",23)(1,"div",24),e.nrm(2,"img",25),e.j41(3,"span",26),e.EFF(4),e.k0s(),e.j41(5,"div",27)(6,"button",28),e.bIt("click",function(){const o=s.eBV(t).$implicit,a=e.XpG(3);return s.Njj(a.updateQuantity(o.productId._id,o.quantity-1))}),e.EFF(7," - "),e.k0s(),e.j41(8,"span",29),e.EFF(9),e.k0s(),e.j41(10,"button",30),e.bIt("click",function(){const o=s.eBV(t).$implicit,a=e.XpG(3);return s.Njj(a.updateQuantity(o.productId._id,o.quantity+1))}),e.EFF(11," + "),e.k0s()()(),e.j41(12,"div",31)(13,"span",32),e.EFF(14),e.nI1(15,"number"),e.k0s(),e.j41(16,"button",33),e.bIt("click",function(){const o=s.eBV(t).$implicit,a=e.XpG(3);return s.Njj(a.removeItem(o.productId._id))}),e.j41(17,"span",34)(18,"mat-icon"),e.EFF(19,"delete_forever"),e.k0s()(),e.j41(20,"span",35)(21,"mat-icon"),e.EFF(22,"delete_outline"),e.k0s()()()()()}if(2&n){const t=l.$implicit;e.R7$(2),e.Y8G("src",t.productId.images&&t.productId.images[0]?t.productId.images[0]:"https://via.placeholder.com/50",e.B4B)("alt",t.productId.productName),e.R7$(2),e.JRh(t.productId.productName),e.R7$(5),e.JRh(t.quantity),e.R7$(5),e.SpI(" \u20b9",e.i5U(15,5,t.productId.price*(1-(t.productId.discount||0)/100)*t.quantity,"1.2-2")," ")}}function U(n,l){if(1&n&&e.Z7z(0,G,23,8,"div",23,e.Vm6),2&n){const t=e.XpG(2);e.Dyx(t.cartItems)}}function Q(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",0)(1,"h1",2),e.EFF(2,"Checkout"),e.k0s(),e.j41(3,"div",3)(4,"form",4)(5,"h2",5),e.EFF(6," Billing Details "),e.k0s(),e.j41(7,"div",6)(8,"mat-form-field",7)(9,"mat-label"),e.EFF(10,"Full Name"),e.k0s(),e.nrm(11,"input",8),e.nVh(12,T,2,0,"mat-error"),e.k0s(),e.j41(13,"mat-form-field",7)(14,"mat-label"),e.EFF(15,"Email"),e.k0s(),e.nrm(16,"input",9),e.nVh(17,$,2,0,"mat-error"),e.nVh(18,R,2,0,"mat-error"),e.k0s(),e.j41(19,"mat-form-field",7)(20,"mat-label"),e.EFF(21,"Phone Number"),e.k0s(),e.j41(22,"input",10),e.bIt("keypress",function(o){s.eBV(t);const a=e.XpG();return s.Njj(a.allowOnlyDigits(o))}),e.k0s(),e.nVh(23,M,2,0,"mat-error"),e.nVh(24,N,2,0,"mat-error"),e.nVh(25,O,2,0,"mat-error"),e.k0s(),e.j41(26,"mat-form-field",7)(27,"mat-label"),e.EFF(28,"Address"),e.k0s(),e.nrm(29,"textarea",11),e.nVh(30,A,2,0,"mat-error"),e.k0s(),e.j41(31,"mat-form-field",7)(32,"mat-label"),e.EFF(33,"Payment Method"),e.k0s(),e.j41(34,"mat-select",12)(35,"mat-option",13),e.EFF(36,"Cash on Delivery"),e.k0s(),e.j41(37,"mat-option",14),e.EFF(38,"Online Payment"),e.k0s()(),e.nVh(39,X,2,0,"mat-error"),e.k0s()()(),e.j41(40,"div",15)(41,"h2",5),e.EFF(42," Cart Summary "),e.k0s(),e.j41(43,"div",16),e.nVh(44,B,2,0,"div",17),e.nVh(45,U,2,0),e.k0s(),e.j41(46,"div",18)(47,"div",19)(48,"span"),e.EFF(49,"Original Total:"),e.k0s(),e.j41(50,"span"),e.EFF(51),e.nI1(52,"number"),e.k0s()(),e.j41(53,"div",20)(54,"span"),e.EFF(55,"Total Discount:"),e.k0s(),e.j41(56,"span"),e.EFF(57),e.nI1(58,"number"),e.k0s()(),e.j41(59,"div",21)(60,"span"),e.EFF(61,"Final Amount:"),e.k0s(),e.j41(62,"span"),e.EFF(63),e.nI1(64,"number"),e.k0s()(),e.j41(65,"button",22),e.bIt("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.placeOrder())}),e.EFF(66," Place Order "),e.k0s()()()()()}if(2&n){let t,r,o,a,b,p,_,C;const c=e.XpG();e.R7$(4),e.Y8G("formGroup",c.checkoutForm),e.R7$(8),e.vxM(null!=(t=c.checkoutForm.get("name"))&&t.hasError("required")?12:-1),e.R7$(5),e.vxM(null!=(r=c.checkoutForm.get("email"))&&r.hasError("required")?17:-1),e.R7$(),e.vxM(null!=(o=c.checkoutForm.get("email"))&&o.hasError("email")?18:-1),e.R7$(5),e.vxM(null!=(a=c.checkoutForm.get("phone"))&&a.hasError("required")?23:-1),e.R7$(),e.vxM(null!=(b=c.checkoutForm.get("phone"))&&b.hasError("pattern")?24:-1),e.R7$(),e.vxM(null!=(p=c.checkoutForm.get("phone"))&&p.hasError("minlength")||null!=(p=c.checkoutForm.get("phone"))&&p.hasError("maxlength")?25:-1),e.R7$(5),e.vxM(null!=(_=c.checkoutForm.get("address"))&&_.hasError("required")?30:-1),e.R7$(9),e.vxM(null!=(C=c.checkoutForm.get("paymentMethod"))&&C.hasError("required")?39:-1),e.R7$(5),e.vxM(0===c.cartItems.length?44:-1),e.R7$(),e.vxM(c.cartItems.length>0?45:-1),e.R7$(6),e.SpI("\u20b9",e.i5U(52,14,c.originalTotal,"1.2-2")),e.R7$(6),e.SpI("\u20b9",e.i5U(58,17,c.totalDiscountAmount,"1.2-2")),e.R7$(6),e.SpI("\u20b9",e.i5U(64,20,c.totalAmount,"1.2-2"))}}function Y(n,l){if(1&n&&e.nrm(0,"app-order-success-page",1),2&n){const t=e.XpG();e.Y8G("orderData",t.commonVariablesService.orderSuccessData)}}let J=(()=>{class n{fb=(0,s.WQX)(i.ok);router=(0,s.WQX)(x.Ix);toaster=(0,s.WQX)(k.N);customerServices=(0,s.WQX)(I.f);commonServices=(0,s.WQX)(j.e);commonVariablesService=(0,s.WQX)(E.y);checkoutForm;cartItems=[];loading=!1;ngOnInit(){var t=this;return(0,d.A)(function*(){t.checkoutForm=t.fb.group({name:[t.commonVariablesService.userData.name||"",i.k0.required],email:[t.commonVariablesService.userData.email||"",[i.k0.required,i.k0.email]],phoneNumber:["",[i.k0.required,i.k0.pattern(/^[0-9]{1,10}$/),i.k0.maxLength(10),i.k0.minLength(10)]],address:["",i.k0.required],paymentMethod:["cod",i.k0.required]}),yield t.loadCart()})()}loadCart(){var t=this;return(0,d.A)(function*(){t.loading=!0;try{const r=localStorage.getItem("user");t.commonVariablesService.userData=JSON.parse(r||"{}");const o=t.commonVariablesService.userData._id,a=yield t.customerServices.getUserCart(o).toPromise();t.commonVariablesService.cartData=a,t.cartItems=a?.productQuantity||[],t.cartItems.length<1&&(t.router.navigateByUrl("/home"),t.toaster.show("Please Add Items into Cart before Checkout!","warning",5e3))}catch(r){console.error(r)}finally{t.loading=!1}})()}updateQuantity(t,r){var o=this;return(0,d.A)(function*(){if(r<1)return void o.removeItem(t);const a={userId:o.commonVariablesService.userData._id,productId:t,quantity:r};yield o.customerServices.addToCart(a).toPromise(),yield o.loadCart()})()}removeItem(t){var r=this;return(0,d.A)(function*(){const o=r.commonVariablesService.userData._id;yield r.customerServices.removeFromCart({userId:o,productId:t}).toPromise(),yield r.loadCart()})()}get originalTotal(){return this.cartItems.reduce((t,r)=>t+(r.productId.price||0)*r.quantity,0)}get totalDiscountAmount(){return this.cartItems.reduce((t,r)=>t+(r.productId.price||0)*(r.productId.discount||0)/100*r.quantity,0)}get totalAmount(){return this.originalTotal-this.totalDiscountAmount}placeOrder(){if(this.checkoutForm.invalid||0===this.cartItems.length)return;let t=[];for(let o=0;o<this.cartItems.length;o++)this.cartItems[o].quantity>0&&t.push({productId:this.cartItems[o].productId._id,quantity:this.cartItems[o].quantity});const r={userId:this.commonVariablesService.userData._id,item:t,status:0,date:new Date,finalAmount:this.totalAmount,...this.checkoutForm.value};this.commonServices.newOrder(r)}allowOnlyDigits(t){/[0-9]/.test(t.key)||t.preventDefault()}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-checkout-page"]],decls:2,vars:1,consts:[[1,"p-[2rem]","mt-[2rem]","max-w-[80rem]","mx-auto"],[3,"orderData"],[1,"text-[1.875rem]","font-bold","mb-[2rem]","text-gray-900"],[1,"flex","flex-col","lg:flex-row","gap-[2rem]"],[1,"flex-1","bg-white","p-[2rem]","border","rounded-[0.75rem]","shadow-md","flex","flex-col",3,"formGroup"],[1,"text-[1.25rem]","font-semibold","mb-[1.5rem]","text-gray-800"],[1,"flex","flex-col","gap-[1.25rem]"],[1,"w-full"],["matInput","","formControlName","name","placeholder","John Doe",1,"text-[1rem]","p-[0.75rem]"],["matInput","","type","email","formControlName","email","placeholder","example@mail.com",1,"text-[1rem]","p-[0.75rem]"],["matInput","","type","tel","formControlName","phoneNumber","placeholder","+91 9876543210","maxlength","10","pattern","[0-9]*",1,"text-[1rem]","p-[0.75rem]",3,"keypress"],["matInput","","formControlName","address","placeholder","Your Address",1,"text-[1rem]","p-[0.75rem]"],["formControlName","paymentMethod",1,"text-[1rem]"],["value","cod"],["value","online"],[1,"flex-1","bg-gray-50","p-[2rem]","border","rounded-[0.75rem]","shadow-md","flex","flex-col","h-[600px]"],[1,"flex-1","overflow-y-auto","flex","flex-col","gap-[1rem]"],[1,"text-[1rem]","text-gray-500","italic"],[1,"mt-[1.5rem]","border-t","border-gray-300","pt-[1.5rem]","flex","flex-col","gap-[0.75rem]","sticky","bottom-0","bg-gray-50","z-10"],[1,"flex","justify-between","text-[1rem]","text-gray-500","line-through"],[1,"flex","justify-between","text-[1rem]","text-red-500"],[1,"flex","justify-between","text-[1.125rem]","font-semibold","text-gray-900"],["mat-raised-button","","color","primary",1,"mt-[1rem]","w-full","text-[1rem]","py-[0.75rem]","rounded-[0.5rem]","bg-green-500","hover:bg-green-600","transition-colors","font-semibold",3,"click"],[1,"flex","justify-between","items-center","bg-white","p-[0.75rem]","rounded-[0.5rem]","shadow-sm"],[1,"flex","items-center","gap-[0.75rem]"],[1,"w-[3rem]","h-[3rem]","object-cover","rounded",3,"src","alt"],[1,"text-[1rem]","text-gray-700","font-medium"],[1,"flex","items-center","rounded","px-[0.25rem]"],[1,"px-[0.5rem]","py-[0.25rem]","bg-gray-200","text-[1rem]","rounded","hover:bg-red-600","transition-colors",3,"click"],[1,"px-[0.5rem]","text-[1rem]"],[1,"px-[0.5rem]","py-[0.25rem]","bg-gray-200","text-[1rem]","rounded","hover:bg-cyan-400","transition-colors",3,"click"],[1,"flex","flex-col","items-end"],[1,"text-[1rem]","font-semibold","text-gray-900"],[1,"text-[0.875rem]","text-black","mt-[0.25rem]","cursor-pointer","flex","items-center","group","relative",3,"click"],[1,"hidden","group-hover:inline","!text-red-600"],[1,"group-hover:hidden"]],template:function(r,o){1&r&&e.nVh(0,Q,67,23,"div",0)(1,Y,1,1,"app-order-success-page",1),2&r&&e.vxM(o.commonVariablesService.orderSuccessData?1:0)},dependencies:[u.MD,i.X1,i.qT,i.me,i.BC,i.cb,i.tU,i.R_,i.j4,i.JD,g.m_,g.An,w.R,h.rl,h.nJ,h.TL,F.fS,F.fg,v.Ve,v.VO,S.wT,y.Hl,y.$z,i.YN,V,u.QX],encapsulation:2})}return n})()}}]);